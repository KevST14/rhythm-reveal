{"version":3,"sources":["../../../../src/client/components/react-dev-overlay/client-entry.tsx"],"sourcesContent":["import React from 'react'\nimport ReactDevOverlay from './app/ReactDevOverlay'\nimport { getSocketUrl } from './internal/helpers/get-socket-url'\nimport { INITIAL_OVERLAY_STATE } from './shared'\nimport { HMR_ACTIONS_SENT_TO_BROWSER } from '../../../server/dev/hot-reloader-types'\n\n// if an error is thrown while rendering an RSC stream, this will catch it in dev\n// and show the error overlay\nexport function createDevOverlayElement(reactEl: React.ReactElement) {\n  const rootLayoutMissingTags = window.__next_root_layout_missing_tags\n  const hasMissingTags = !!rootLayoutMissingTags?.length\n  const socketUrl = getSocketUrl(process.env.__NEXT_ASSET_PREFIX || '')\n  const socket = new window.WebSocket(`${socketUrl}/_next/webpack-hmr`)\n\n  // add minimal \"hot reload\" support for RSC errors\n  const handler = (event: MessageEvent) => {\n    let obj\n    try {\n      obj = JSON.parse(event.data)\n    } catch {}\n\n    if (!obj || !('action' in obj)) {\n      return\n    }\n\n    if (obj.action === HMR_ACTIONS_SENT_TO_BROWSER.SERVER_COMPONENT_CHANGES) {\n      window.location.reload()\n    }\n  }\n\n  socket.addEventListener('message', handler)\n\n  const FallbackLayout = hasMissingTags\n    ? ({ children }: { children: React.ReactNode }) => (\n        <html id=\"__next_error__\">\n          <body>{children}</body>\n        </html>\n      )\n    : React.Fragment\n\n  return (\n    <FallbackLayout>\n      <ReactDevOverlay\n        state={{ ...INITIAL_OVERLAY_STATE, rootLayoutMissingTags }}\n      >\n        {reactEl}\n      </ReactDevOverlay>\n    </FallbackLayout>\n  )\n}\n"],"names":["React","ReactDevOverlay","getSocketUrl","INITIAL_OVERLAY_STATE","HMR_ACTIONS_SENT_TO_BROWSER","createDevOverlayElement","reactEl","rootLayoutMissingTags","window","__next_root_layout_missing_tags","hasMissingTags","length","socketUrl","process","env","__NEXT_ASSET_PREFIX","socket","WebSocket","handler","event","obj","JSON","parse","data","action","SERVER_COMPONENT_CHANGES","location","reload","addEventListener","FallbackLayout","children","html","id","body","Fragment","state"],"mappings":";AAAA,OAAOA,WAAW,QAAO;AACzB,OAAOC,qBAAqB,wBAAuB;AACnD,SAASC,YAAY,QAAQ,oCAAmC;AAChE,SAASC,qBAAqB,QAAQ,WAAU;AAChD,SAASC,2BAA2B,QAAQ,yCAAwC;AAEpF,iFAAiF;AACjF,6BAA6B;AAC7B,OAAO,SAASC,wBAAwBC,OAA2B;IACjE,MAAMC,wBAAwBC,OAAOC,+BAA+B;IACpE,MAAMC,iBAAiB,CAAC,EAACH,yCAAAA,sBAAuBI,MAAM;IACtD,MAAMC,YAAYV,aAAaW,QAAQC,GAAG,CAACC,mBAAmB,IAAI;IAClE,MAAMC,SAAS,IAAIR,OAAOS,SAAS,CAAC,AAAC,KAAEL,YAAU;IAEjD,kDAAkD;IAClD,MAAMM,UAAU,CAACC;QACf,IAAIC;QACJ,IAAI;YACFA,MAAMC,KAAKC,KAAK,CAACH,MAAMI,IAAI;QAC7B,EAAE,UAAM,CAAC;QAET,IAAI,CAACH,OAAO,CAAE,CAAA,YAAYA,GAAE,GAAI;YAC9B;QACF;QAEA,IAAIA,IAAII,MAAM,KAAKpB,4BAA4BqB,wBAAwB,EAAE;YACvEjB,OAAOkB,QAAQ,CAACC,MAAM;QACxB;IACF;IAEAX,OAAOY,gBAAgB,CAAC,WAAWV;IAEnC,MAAMW,iBAAiBnB,iBACnB;YAAC,EAAEoB,QAAQ,EAAiC;6BAC1C,KAACC;YAAKC,IAAG;sBACP,cAAA,KAACC;0BAAMH;;;QAGX9B,MAAMkC,QAAQ;IAElB,qBACE,KAACL;kBACC,cAAA,KAAC5B;YACCkC,OAAO;gBAAE,GAAGhC,qBAAqB;gBAAEI;YAAsB;sBAExDD;;;AAIT"}